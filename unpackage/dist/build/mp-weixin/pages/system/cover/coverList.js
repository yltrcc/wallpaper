(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/system/cover/coverList"],{"1c11":function(e,t,n){"use strict";(function(e){n("acd6");a(n("66fd"));var t=a(n("ae3b"));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},2490:function(e,t,n){},"6a79":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("a34a"));function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,a,r,o,u){try{var i=e[o](u),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(a,r)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){u(o,a,r,i,c,"next",e)}function c(e){u(o,a,r,i,c,"throw",e)}i(void 0)}))}}var c=function(){n.e("components/model/model").then(function(){return resolve(n("430a"))}.bind(null,n)).catch(n.oe)},s={data:function(){return{tagCurrent:0,tagList:[{name:"全部"},{name:"待审核"},{name:"已驳回"}],navbarTop:0,coverList:[],sheetList:[{text:"删除"}],sheetShow:!1,noData:!1,pageIndex:0,loadStatus:"loadmore",examine:"",coverId:"",userId:"",coverStatus:"",editShow:!1}},components:{models:c},onLoad:function(e){var t=e.userId,n=this;t&&(n.userId=t),n.getCoverList(n.tagCurrent,1)},onShow:function(){var t=this;return i(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=t,e.getStorageSync("update_flag")&&(a.getCoverList(a.orderStatus,1),e.removeStorageSync("update_flag"));case 2:case"end":return n.stop()}}),n)})))()},methods:{cateClick:function(e){e!=this.tagCurrent&&(this.tagCurrent=e,this.getCoverList(e,1))},getCoverList:function(e,t){var n=this;return i(r.default.mark((function o(){var u,i,c,s;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return u=n,i=u.coverList,1==t&&(u.coverList=[],i=[],u.pageIndex=0),u.pageIndex=u.pageIndex+1,u.noData=!1,u.loadStatus="loading",c={},1==e?c={status:0}:2==e&&(c={status:2}),u.userId&&(c.user_id=u.userId),r.next=11,a.callFunction({name:"query_list",data:{dbName:"wx_cover",filter:c,order:{name:"time",type:"desc"},pageIndex:u.pageIndex,pageSize:10}});case 11:s=r.sent,s.result.hasMore?u.loadStatus="loadmore":u.loadStatus="nomore",i=i.concat(s.result.data),u.coverList=i,0==u.coverList.length?u.noData=!0:u.noData=!1;case 16:case"end":return r.stop()}}),o)})))()},delClick:function(t){var n=this;e.showModal({title:"删除提示",content:"确定删除当前作品吗？",confirmText:"删除",confirmColor:"#fcc600",success:function(){var o=i(r.default.mark((function o(u){var i;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!u.confirm){r.next=7;break}return e.showLoading({mask:!0,title:"删除中..."}),r.next=4,a.callFunction({name:"query_del",data:{dbName:"wx_cover",filter:{_id:t}}});case 4:i=r.sent,i.result.success&&n.getCoverList(n.tagCurrent,1),e.showToast({icon:"none",title:i.result.msg,mask:!0,duration:1e3});case 7:case"end":return r.stop()}}),o)})));function u(e){return o.apply(this,arguments)}return u}()})},editChange:function(e,t){var n=this;if(e&&t)n.coverId=e,n.coverStatus=t,1===t||3===t?n.examineClick():n.editShow=!0;else{if(!n.examine)return n.$refs.uModal.clearLoading(),void n.$u.toast("请填写拒绝原因");var a=n.examine;n.examine="",n.editShow=!1,n.examineClick(a)}},examineClick:function(t){var n=this,o="确定审核通过吗？";2===n.coverStatus&&(o="确定驳回吗？"),3===n.coverStatus&&(o="确定下架吗？"),e.showModal({title:"审核提示",content:o,confirmColor:"#fcc600",success:function(){var o=i(r.default.mark((function o(u){var i,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!u.confirm){r.next=15;break}return e.showLoading({mask:!0,title:"正在拼命加载中..."}),r.next=4,a.callFunction({name:"query_edit",data:{dbName:"wx_cover",filter:{_id:n.coverId},upData:{status:n.coverStatus,examine:t}}});case 4:if(i=r.sent,!i.result.success){r.next=14;break}return n.getCoverList(n.tagCurrent,1),e.showToast({icon:"none",title:"审核成功",mask:!0,duration:1e3}),r.next=10,a.callFunction({name:"template_send",data:{coverId:n.coverId}});case 10:c=r.sent,c.result.success||e.showToast({icon:"none",title:c.result.msg,mask:!0,duration:5e3}),r.next=15;break;case 14:e.showToast({icon:"none",title:i.result.msg,mask:!0,duration:1e3});case 15:case"end":return r.stop()}}),o)})));function u(e){return o.apply(this,arguments)}return u}()})},niceClick:function(t,n){var o=this;return i(r.default.mark((function u(){var i,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i=o,e.showLoading({mask:!0,title:"正在拼命加载中..."}),r.next=4,a.callFunction({name:"query_edit",data:{dbName:"wx_cover",filter:{_id:t},upData:{cover_nice:n}}});case 4:c=r.sent,c.result.success&&i.getCoverList(i.tagCurrent,1),e.showToast({icon:"none",title:c.result.msg,mask:!0,duration:1e3});case 7:case"end":return r.stop()}}),u)})))()},detailClick:function(t){e.navigateTo({url:"/pages/detail/detail?id="+t+"&index=0"})},editClick:function(t){e.navigateTo({url:"/pages/write/edit?id="+t})},stockClick:function(t){e.navigateTo({url:"/pages/write/stock?id="+t})}},onReachBottom:function(){var e=this;"nomore"!=e.loadStatus&&e.getCoverList(e.tagCurrent)}};t.default=s}).call(this,n("543d")["default"],n("a9ff")["default"])},"73ff":function(e,t,n){"use strict";n.r(t);var a=n("6a79"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},ae3b:function(e,t,n){"use strict";n.r(t);var a=n("e292"),r=n("73ff");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("d10b");var u,i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],u);t["default"]=c.exports},d10b:function(e,t,n){"use strict";var a=n("2490"),r=n.n(a);r.a},e292:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var a={uTabs:function(){return n.e("uview-ui/components/u-tabs/u-tabs").then(n.bind(null,"cca7"))},uGap:function(){return n.e("uview-ui/components/u-gap/u-gap").then(n.bind(null,"76ad"))},uLoadmore:function(){return n.e("uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"f49c"))},uModal:function(){return n.e("uview-ui/components/u-modal/u-modal").then(n.bind(null,"34c8"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"4cd0"))},uActionSheet:function(){return n.e("uview-ui/components/u-action-sheet/u-action-sheet").then(n.bind(null,"7ed0"))}},r=function(){var e=this,t=e.$createElement;e._self._c},o=[]}},[["1c11","common/runtime","common/vendor"]]]);